import{a as y,b as R,c as B,d as b,e as C}from"./chunk-R7U4NZFW.js";import{A as h,E as i,G as k,H as E,T,i as _,j as x,l,m as S,o as c,p as m,q as p,r as g,s as u,t as e,u as t,v as s}from"./chunk-ZW3TMCPU.js";var D=(r,o)=>o.isbn;function M(r,o){r&1&&(s(0,"span",17),e(1,"span",18),i(2,"Loading..."),t())}function w(r,o){if(r&1&&s(0,"app-book-card",19),r&2){let a=o.$implicit;u("book",a)}}function V(r,o){r&1&&(e(0,"div",15),p(1,w,1,1,"app-book-card",19,D),t()),r&2&&(l(),g(o))}function I(r,o){r&1&&(s(0,"span",17),e(1,"span",18),i(2,"Loading..."),t())}function N(r,o){if(r&1&&s(0,"app-book-card",19),r&2){let a=o.$implicit;u("book",a)}}function F(r,o){r&1&&(e(0,"div",15),p(1,N,1,1,"app-book-card",19,D),t()),r&2&&(l(),g(o))}var f=class r{bookService=_(b);searchTerms=["Angular","TypeScript","Node","JavaScript"];searchTerm=x(this.searchTerms[0]);constructor(){this.bookService.toggleSlowMode()}buggyResource=y({params:()=>this.searchTerm(),stream:({params:o})=>this.bookService.searchBooks(o)});fixedResource=C({params:()=>this.searchTerm(),stream:({params:o})=>this.bookService.searchBooks(o)});nextSearch(){this.searchTerm.update(o=>this.getNextSearch(o))}getNextSearch(o){let n=(this.searchTerms.indexOf(o)+1)%this.searchTerms.length;return this.searchTerms[n]}static \u0275fac=function(a){return new(a||r)};static \u0275cmp=S({type:r,selectors:[["app-bug1-value-reset"]],features:[E([b])],decls:57,vars:7,consts:[[1,"demo-container"],[1,"demo-header"],["routerLink","/","aria-label","Back to home",1,"back-link"],[1,"subtitle"],[1,"github"],["href","https://github.com/angular/angular/issues/58602","target","_blank"],[1,"controls"],[1,"hint"],[1,"control-buttons"],["type","button",1,"btn-primary",3,"click"],[3,"slowModeToggle","errorModeToggle","isSlowModeEnabled","isErrorModeEnabled"],[1,"comparison"],[1,"demo-card","buggy"],[1,"card-header"],[1,"card-body"],[1,"books-grid"],[1,"demo-card","fixed"],[1,"spinner-tiny"],[1,"loading-text"],[3,"book"]],template:function(a,n){if(a&1&&(e(0,"div",0)(1,"header",1)(2,"a",2),i(3,"\u2190 Back to Home"),t(),e(4,"h1"),i(5,"Bug #1: Value Resets When Parameters Change"),t(),e(6,"p",3),i(7," When you change parameters, the previous book list should remain visible while new data is being fetched. Instead, the resource immediately sets "),e(8,"code"),i(9,"value()"),t(),i(10," to "),e(11,"code"),i(12,"undefined"),t(),i(13,". All book cards disappear. The DOM collapses. The scroll position jumps. Users are disoriented by the flickering. At minimum, this behavior should be configurable. "),t(),e(14,"p",4)(15,"strong"),i(16,"Affects:"),t(),e(17,"code"),i(18,"resource()"),t(),i(19,", "),e(20,"code"),i(21,"rxResource()"),t(),i(22,", and "),e(23,"code"),i(24,"httpResource()"),t(),i(25," (all share the same foundation)"),s(26,"br"),e(27,"strong"),i(28,"Related Issue:"),t(),e(29,"a",5),i(30,"#58602"),t()()(),e(31,"section",6)(32,"p",7),i(33,` Press "Next Search Term" to change parameters and see the flickering. If data comes too fast, try out slow mode! Note: Errors are intentionally NOT handled on this page. If you activate error mode, an uncaught exception will occur. You can see it in your browser's dev tools. `),t(),e(34,"div",8)(35,"button",9),h("click",function(){return n.nextSearch()}),i(36),t(),e(37,"app-control-buttons",10),h("slowModeToggle",function(){return n.bookService.toggleSlowMode()})("errorModeToggle",function(){return n.bookService.toggleErrorMode()}),t()()(),e(38,"section",11)(39,"article",12)(40,"header",13)(41,"h3"),i(42," \u{1F534} BUGGY: rxResource "),c(43,M,3,0),t(),e(44,"p"),i(45,"Standard rxResource clears value when parameters change. Watch the data disappear and reappear!"),t()(),e(46,"div",14),c(47,V,3,0,"div",15),t()(),e(48,"article",16)(49,"header",13)(50,"h3"),i(51," \u{1F7E2} FIXED: rxResourceFixed "),c(52,I,3,0),t(),e(53,"p"),i(54,"rxResourceFixed preserves previous data when parameters change. Data stays visible until new data arrives!"),t()(),e(55,"div",14),c(56,F,3,0,"div",15),t()()()()),a&2){let d,v;l(36),k(' \u{1F50D} Next Search Term: "',n.searchTerm(),'" '),l(),u("isSlowModeEnabled",n.bookService.isSlowModeEnabled())("isErrorModeEnabled",n.bookService.isErrorModeEnabled()),l(6),m(n.buggyResource.isLoading()?43:-1),l(4),m((d=n.buggyResource.value())?47:-1,d),l(5),m(n.fixedResource.isLoading()?52:-1),l(4),m((v=n.fixedResource.value())?56:-1,v)}},dependencies:[T,R,B],styles:[".books-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem;margin-bottom:1rem}"],changeDetection:0})};export{f as default};
