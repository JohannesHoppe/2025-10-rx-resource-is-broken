import{B as x,D as R,E as u,F as q,J as j,K as U,L as N,M as T,N as p,P as h,Q as $,a as b,b as f,c as l,d as S,e as O,f as B,g as M,h as _,i as E,j as g,k as I,l as a,m as v,n as k,o as w,p as C,w as d,x as c,y as P,z as F}from"./chunk-ZW3TMCPU.js";function L(t){return U(f(b({},t),{loader:void 0,stream:o=>{let e,n=()=>e?.unsubscribe();o.abortSignal.addEventListener("abort",n);let s=g({value:void 0}),r,m=new Promise(i=>r=i);function y(i){s.set(i),r?.(s),r=void 0}let D=t.stream??t.loader;if(D===void 0)throw new M(990,!1);return e=D(o).subscribe({next:i=>y({value:i}),error:i=>{y({error:N(i)}),o.abortSignal.removeEventListener("abort",n)},complete:()=>{r&&y({error:new M(991,!1)}),o.abortSignal.removeEventListener("abort",n)}}),m}}))}var V=class t{book=p.required();static \u0275fac=function(e){return new(e||t)};static \u0275cmp=v({type:t,selectors:[["app-book-card"]],inputs:{book:[1,"book"]},decls:4,vars:3,consts:[[1,"book-card"],["loading","lazy","decoding","async",1,"book-cover",3,"src","alt"]],template:function(e,n){e&1&&(d(0,"div",0),P(1,"img",1),d(2,"h4"),u(3),c()()),e&2&&(a(),F("src",n.book().imageUrl,I)("alt",n.book().title),a(2),q(n.book().title))},styles:[".book-card[_ngcontent-%COMP%]{text-align:center}.book-cover[_ngcontent-%COMP%]{width:100%;max-width:200px;height:auto;border-radius:4px;margin-bottom:.5rem;box-shadow:0 3px 6px #0000001f}h4[_ngcontent-%COMP%]{font-size:.9rem;margin:0;color:#333}"],changeDetection:0})};function K(t,o){t&1&&u(0," \u23F1\uFE0F Slow Mode ON ")}function G(t,o){t&1&&u(0," \u23F1\uFE0F Slow Mode OFF ")}function J(t,o){t&1&&u(0," \u2717 Error Mode ON ")}function Q(t,o){t&1&&u(0," \u2713 Error Mode OFF ")}var z=class t{isSlowModeEnabled=p.required();isErrorModeEnabled=p.required();slowModeToggle=T();errorModeToggle=T();static \u0275fac=function(e){return new(e||t)};static \u0275cmp=v({type:t,selectors:[["app-control-buttons"]],inputs:{isSlowModeEnabled:[1,"isSlowModeEnabled"],isErrorModeEnabled:[1,"isErrorModeEnabled"]},outputs:{slowModeToggle:"slowModeToggle",errorModeToggle:"errorModeToggle"},decls:6,vars:12,consts:[["type","button",1,"btn-primary","text-nowrap",3,"click"]],template:function(e,n){e&1&&(d(0,"button",0),x("click",function(){return n.slowModeToggle.emit()}),w(1,K,1,0)(2,G,1,0),c(),d(3,"button",0),x("click",function(){return n.errorModeToggle.emit()}),w(4,J,1,0)(5,Q,1,0),c()),e&2&&(R("btn-danger",n.isSlowModeEnabled())("btn-success",!n.isSlowModeEnabled()),k("aria-pressed",n.isSlowModeEnabled()),a(),C(n.isSlowModeEnabled()?1:2),a(2),R("btn-danger",n.isErrorModeEnabled())("btn-success",!n.isErrorModeEnabled()),k("aria-pressed",n.isErrorModeEnabled()),a(),C(n.isErrorModeEnabled()?4:5))},styles:["[_nghost-%COMP%]{display:contents}"],changeDetection:0})};var A=class t{http=E($);apiBaseUrl="https://api6.angular-buch.com";simulateError=!1;slowModeDelay=0;toggleErrorMode(){this.simulateError=!this.simulateError}isErrorModeEnabled(){return this.simulateError}toggleSlowMode(){this.slowModeDelay=this.slowModeDelay>0?0:3e3}isSlowModeEnabled(){return this.slowModeDelay>0}getBook(o){let e=`${this.apiBaseUrl}/books/${o}`;return this.makeRequest(e,this.http.get(e))}getAllBooks(){let o=`${this.apiBaseUrl}/books`;return this.makeRequest(o,this.http.get(o))}searchBooks(o){let e=`${this.apiBaseUrl}/books?search=${encodeURIComponent(o)}`;return this.makeRequest(e,this.http.get(e))}makeRequest(o,e){let n=this.simulateError?l(()=>new h({status:500,statusText:"Internal Server Error",url:o,error:{message:"Simulated server error for testing"}})):e;return S(this.slowModeDelay).pipe(B(()=>n))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=_({token:t,factory:t.\u0275fac})};function Fe(t){let o=g(0),e=L(f(b({},t),{params:()=>({userParams:t.params?.()??void 0,_refresh:o()}),stream:r=>t.stream({params:r.params.userParams,abortSignal:r.abortSignal,previous:r.previous}).pipe(X())})),n=j({source:()=>e.status(),computation:(r,m)=>{if(r!=="error")return r==="loading"?m?.value??e.value():e.value()}}),s=n;return s.set=e.value.set.bind(e.value),s.update=e.value.update.bind(e.value),s.asReadonly=n.asReadonly.bind(n),{value:s,isLoading:e.isLoading,error:e.error,status:e.status,hasValue:()=>n()!==void 0&&e.error()==null,reload:()=>(o.update(r=>r+1),!0),set:e.set.bind(e),update:e.update.bind(e),asReadonly:e.asReadonly.bind(e),destroy:e.destroy.bind(e)}}function X(){return O(t=>{if(t instanceof h){let o=t.status===0?"Network Error":`HTTP Error ${t.status}`,e=new Error(`${o}${t.message?`: ${t.message}`:""}`,{cause:t});return l(()=>e)}return l(()=>t)})}export{L as a,V as b,z as c,A as d,Fe as e};
