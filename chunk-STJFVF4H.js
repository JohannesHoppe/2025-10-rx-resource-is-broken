import{a as C}from"./chunk-4DVWLT4T.js";import{a as y,b as v,c as R,d as b,e as B}from"./chunk-R7U4NZFW.js";import{A as u,C as g,E as e,H as k,T as S,i as f,j as h,l as d,m as _,o as s,p as c,s as m,t as r,u as t,v as l}from"./chunk-ZW3TMCPU.js";function T(n,o){n&1&&(l(0,"span",20),r(1,"span",21),e(2,"Loading..."),t())}function D(n,o){if(n&1&&l(0,"app-book-card",17),n&2){let a=g().buggyResource.value();m("book",a)}}function H(n,o){n&1&&l(0,"app-error-display",18),n&2&&m("error",o)}function I(n,o){n&1&&(l(0,"span",20),r(1,"span",21),e(2,"Loading..."),t())}function M(n,o){n&1&&l(0,"app-error-display",18),n&2&&m("error",o)}function w(n,o){if(n&1&&l(0,"app-book-card",17),n&2){let a=g().fixedResource.value();m("book",a)}}var E=class n{bookService=f(b);bookIsbns=["9783864909467","9783864907791","9783864906466","9783864903571","9783960092421","9783960092186","9783864909009","9783960091578","9783960091417","9783864907845","9783864905520","9783864904523"];selectedIsbn=h(this.bookIsbns[0]);buggyResource=y({params:()=>this.selectedIsbn(),stream:({params:o})=>this.bookService.getBook(o)});fixedResource=B({params:()=>this.selectedIsbn(),stream:({params:o})=>this.bookService.getBook(o)});loadNext(){this.selectedIsbn.update(o=>this.getNextIsbn(o))}getNextIsbn(o){let i=(this.bookIsbns.indexOf(o)+1)%this.bookIsbns.length;return this.bookIsbns[i]}static \u0275fac=function(a){return new(a||n)};static \u0275cmp=_({type:n,selectors:[["app-bug2-error-handling"]],features:[k([b])],decls:83,vars:7,consts:[[1,"demo-container"],[1,"demo-header"],["routerLink","/","aria-label","Back to home",1,"back-link"],[1,"subtitle"],[1,"github"],["href","https://github.com/angular/angular/issues/61861","target","_blank"],["href","https://github.com/angular/angular/pull/61441","target","_blank"],["href","https://github.com/angular/angular/commit/9045e229c2899ee910ff6ce41fa822f2af5f88bf","target","_blank"],[1,"controls"],[1,"hint"],[1,"control-buttons"],["type","button",1,"btn-primary",3,"click"],[3,"slowModeToggle","errorModeToggle","isSlowModeEnabled","isErrorModeEnabled"],[1,"comparison"],[1,"demo-card","buggy"],[1,"card-header"],[1,"card-body"],[3,"book"],[3,"error"],[1,"demo-card","fixed"],[1,"spinner-tiny"],[1,"loading-text"]],template:function(a,i){if(a&1&&(r(0,"div",0)(1,"header",1)(2,"a",2),e(3,"\u2190 Back to Home"),t(),r(4,"h1"),e(5,"Bug #2: HttpErrorResponse Gets Wrapped"),t(),r(6,"p",3),e(7," When an HTTP error occurs, you want to check the error and display appropriate messages to your users. Instead, both "),r(8,"code"),e(9,"resource"),t(),e(10," and "),r(11,"code"),e(12,"rxResource"),t(),e(13," check if the error inherits from the "),r(14,"code"),e(15,"Error"),t(),e(16," class. Since "),r(17,"code"),e(18,"HttpErrorResponse"),t(),e(19," only implements the "),r(20,"code"),e(21,"Error"),t(),e(22," interface (doesn't inherit from it), it gets wrapped in "),r(23,"code"),e(24,"ResourceWrappedError"),t(),e(25," with an unhelpful message. You must dig into the "),r(26,"code"),e(27,".cause"),t(),e(28," property to access actual HTTP error details. This makes error handling cumbersome. "),t(),r(29,"p",4)(30,"strong"),e(31,"Affects:"),t(),r(32,"code"),e(33,"resource()"),t(),e(34," and "),r(35,"code"),e(36,"rxResource()"),t(),e(37,". "),r(38,"code"),e(39,"httpResource()"),t(),e(40," is typically not affected."),l(41,"br"),r(42,"strong"),e(43,"Related Issue:"),t(),r(44,"a",5),e(45,"#61861"),t(),l(46,"br"),r(47,"strong"),e(48,"Regression:"),t(),r(49,"a",6),e(50,"PR #61441"),t(),e(51," ("),r(52,"a",7),e(53,"Commit 9045e22"),t(),e(54,") "),t()(),r(55,"section",8)(56,"p",9),e(57,' Enable "Error Mode" and press "Load Next Book" to see how errors are handled. '),t(),r(58,"div",10)(59,"button",11),u("click",function(){return i.loadNext()}),e(60," \u{1F4DA} Load Next Book "),t(),r(61,"app-control-buttons",12),u("slowModeToggle",function(){return i.bookService.toggleSlowMode()})("errorModeToggle",function(){return i.bookService.toggleErrorMode()}),t()()(),r(62,"section",13)(63,"article",14)(64,"header",15)(65,"h3"),e(66," \u{1F534} BUGGY: rxResource "),s(67,T,3,0),t(),r(68,"p"),e(69,"HttpErrorResponse wrapped in ResourceWrappedError"),t()(),r(70,"div",16),s(71,D,1,1,"app-book-card",17),s(72,H,1,1,"app-error-display",18),t()(),r(73,"article",19)(74,"header",15)(75,"h3"),e(76," \u{1F7E2} FIXED: rxResourceFixed "),s(77,I,3,0),t(),r(78,"p"),e(79,"Direct access to HttpErrorResponse details"),t()(),r(80,"div",16),s(81,M,1,1,"app-error-display",18)(82,w,1,1,"app-book-card",17),t()()()()),a&2){let p,x;d(61),m("isSlowModeEnabled",i.bookService.isSlowModeEnabled())("isErrorModeEnabled",i.bookService.isErrorModeEnabled()),d(6),c(i.buggyResource.isLoading()?67:-1),d(4),c(i.buggyResource.hasValue()?71:-1),d(),c((p=i.buggyResource.error())?72:-1,p),d(5),c(i.fixedResource.isLoading()?77:-1),d(4),c((x=i.fixedResource.error())?81:i.fixedResource.hasValue()?82:-1,x)}},dependencies:[S,v,R,C],encapsulation:2,changeDetection:0})};export{E as default};
